{% assign embed_width = layout.embed-content-width | default: "75%" %}
<div class="blog-embed-card content-embed-card">
  {% if include.src %}
    <!-- VIDEO MODE -->
    {% assign is_local_video = false %}
    {% if include.src contains '.mp4' or include.src contains '.webm' or include.src contains '.ogg' %}
      {% unless include.src contains 'youtube.com' or include.src contains 'vimeo.com' or include.src contains 'http://' or include.src contains 'https://' %}
        {% assign is_local_video = true %}
      {% endunless %}
    {% endif %}
    
    <a href="{{ include.url | default: include.src }}" class="blog-embed-link-wrapper content-embed-link-wrapper">
      <div class="blog-embed-video-container">
        <div class="blog-embed-video-wrapper content-embed-video-wrapper">
          {% if is_local_video %}
          <video
            class="video-embed-minimal content-embed-iframe"
            src="{{ include.src }}"
            controls
            preload="none"
            {% if include.img %}poster="{{ include.img }}"{% endif %}
          ></video>
          {% else %}
          <iframe
            class="video-embed-minimal content-embed-iframe"
            src="{{ include.src }}"
            title="{{ include.title | escape }}"
            allowfullscreen
            loading="lazy"
            referrerpolicy="strict-origin-when-cross-origin"
          ></iframe>
          {% endif %}
        </div>
      </div>
      <div class="blog-embed-meta content-embed-meta">
        {% if include.title %}
          <div class="blog-embed-title content-embed-title">
            {{ include.title }}
          </div>
        {% endif %}
        {% if include.description %}
          <div class="blog-embed-description content-embed-description">
            {{ include.description }}
          </div>
        {% endif %}
        {% if include.author or include.date %}
          <div class="content-embed-metadata">{% if include.author %}by {{ include.author }}{% endif %}{% if include.date %}{% if include.author %}, {% endif %}<span class="blog-embed-date">{{ include.date | date: "%B %d, %Y" }}</span>{% endif %}</div>
        {% endif %}
      </div>
    </a>
  {% else %}
    <!-- BLOG MODE -->
    <a href="{{ include.url }}" target="_blank" rel="noopener" class="blog-embed-link-wrapper">
      {% if include.img %}
        <div class="blog-embed-image-container">
          <img src="{{ include.img }}" alt="{{ include.alt | default: include.url }}" class="blog-embed-image" loading="lazy" />
        </div>
      {% endif %}
      <div class="blog-embed-meta">
        {% if include.title %}
          <div class="blog-embed-title content-embed-title">
            {{ include.title }}
          </div>
        {% endif %}
        {% if include.description %}
          <div class="blog-embed-description content-embed-description">
            {{ include.description }}
          </div>
        {% endif %}
        {% if include.site %}
          <div class="blog-embed-site-line content-embed-metadata-mb">{{ include.site }}</div>
        {% endif %}
        {% if include.author or include.date %}
          <div class="content-embed-metadata-mb">{% if include.author %}by {{ include.author }}{% endif %}{% if include.date %}{% if include.author %}, {% endif %}<span class="blog-embed-date">{{ include.date | date: "%B %d, %Y" }}</span>{% endif %}</div>
        {% endif %}
      </div>
    </a>
  {% endif %}
</div>
